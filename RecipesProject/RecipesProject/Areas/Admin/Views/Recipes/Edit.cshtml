@using RecipesProject.Areas.Admin.Models
@model EditRecipeViewModel

<div class="container">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h2>Edit Recipe</h2>
            <form asp-action="EditRecipe" method="post" class="needs-validation" novalidate>
                <input type="hidden" asp-for="Id" />

                <div class="form-group">
                    <label for="Title">Title:</label>
                    <input type="text" id="Title" class="form-control" asp-for="Title" required />
                    <div class="invalid-feedback">
                        Please provide a title.
                    </div>
                </div>

                <div class="form-group">
                    <label for="Description">Description:</label>
                    <textarea id="Description" class="form-control" asp-for="Description" required></textarea>
                    <div class="invalid-feedback">
                        Please provide a description.
                    </div>
                </div>

                <div class="form-group">
                    <label for="Instructions">Instructions:</label>
                    <textarea id="Instructions" class="form-control" asp-for="Instructions" required></textarea>
                    <div class="invalid-feedback">
                        Please provide instructions.
                    </div>
                </div>

                <div class="form-row">
                    <div class="col">
                        <label for="PrepTime">Prep Time (minutes):</label>
                        <input type="number" id="PrepTime" class="form-control" asp-for="PrepTime" required />
                        <div class="invalid-feedback">
                            Please provide the prep time.
                        </div>
                    </div>
                    <div class="col">
                        <label for="CookTime">Cook Time (minutes):</label>
                        <input type="number" id="CookTime" class="form-control" asp-for="CookTime" required />
                        <div class="invalid-feedback">
                            Please provide the cook time.
                        </div>
                    </div>
                    <div class="col">
                        <label for="TotalTime">Total Time (minutes):</label>
                        <input type="number" id="TotalTime" class="form-control" asp-for="TotalTime" required />
                        <div class="invalid-feedback">
                            Please provide the total time.
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="Servings">Servings:</label>
                    <input type="number" id="Servings" class="form-control" asp-for="Servings" required />
                    <div class="invalid-feedback">
                        Please provide the number of servings.
                    </div>
                </div>

                <div class="form-group">
                    <label for="Image">Image URL:</label>
                    <input type="text" id="Image" class="form-control" asp-for="Image" required />
                    <div class="invalid-feedback">
                        Please provide the image URL.
                    </div>
                </div>

                <div class="form-group">
                    <label for="CategoryId">Category:</label>
                    <select id="CategoryId" class="form-control" asp-for="CategoryId" asp-items="ViewBag.CategoryId" required>
                        <option value="">Select Category</option>
                    </select>
                    <div class="invalid-feedback">
                        Please select a category.
                    </div>
                </div>
                <h4>Ingredients:</h4>
<div id="ingredients">
    @foreach (var ingredient in Model.Ingredients)
    {
        <div class="ingredient">
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="IngredientName">Name:</label>
                    <input type="text" id="IngredientName" class="form-control" asp-for="@ingredient.Name" required />
                    <div class="invalid-feedback">
                        Please provide the ingredient name.
                    </div>
                </div>
                <div class="form-group col-md-6">
                    <label for="IngredientQuantity">Quantity:</label>
                    <input type="text" id="IngredientQuantity" class="form-control" asp-for="@ingredient.Quantity" required />
                    <div class="invalid-feedback">
                        Please provide the ingredient quantity.
                    </div>
                </div>
            </div>
        </div>
    }
</div>

                <button type="button" id="addIngredient" class="btn btn-primary">Add Ingredient</button>
                <button type="submit" class="btn btn-success">Save</button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#addIngredient').click(function () {
                var index = $('#ingredients div.ingredient').length;
                var html = '<div class="ingredient">' +
                    '<div class="form-group">' +
                    '<label for="Ingredients_' + index + '__Name">Name:</label>' +
                    '<input type="text" id="Ingredients_' + index + '__Name" class="form-control" name="Ingredients[' + index + '].Name" required />' +
                    '<div class="invalid-feedback">' +
                    'Please provide the ingredient name.' +
                    '</div>' +
                    '</div>' +
                    '<div class="form-group">' +
                    '<label for="Ingredients_' + index + '__Quantity">Quantity:</label>' +
                    '<input type="text" id="Ingredients_' + index + '__Quantity" class="form-control" name="Ingredients[' + index + '].Quantity" required />' +
                    '<div class="invalid-feedback">' +
                    'Please provide the ingredient quantity.' +
                    '</div>' +
                    '</div>' +
                    '</div>';
                $('#ingredients').append(html);
            });
        });
    </script>
}